<ion-header>
  <ion-toolbar>
    <ion-grid>
      <ion-row >
        <ion-col size="2" style="text-align: center">
          <ion-icon class="titleBack" name="arrow-round-back" (click)="back()" ></ion-icon>
        </ion-col>
        <ion-col size="10">
          <ion-label class="titleText">Comments</ion-label>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ion-toolbar>
</ion-header>
<ion-content>
  <ion-list lines="none" *ngIf="comments">
    <ion-grid class="main">
      <ion-row class="like-row" *ngFor="let comment of comments"  >
        <ion-col size="2" (click)="getUserProfile(comment.user_id, comment.profile_picture, comment.first_name+' '+comment.last_name)">
          <ion-avatar class="avatar userImg">
            <img class="" [src]="profileimg(comment.profile_picture)"/>
          </ion-avatar>
        </ion-col>
        <ion-col class="" size="10">
          <ion-row>
            <ion-col size="8" (click)="getUserProfile(comment.user_id, comment.profile_picture, comment.first_name+' '+comment.last_name)">
              <ion-label class="" >
                <span class="username-span">{{comment.first_name+' '+comment.last_name|titlecase}}</span>
              </ion-label>
            </ion-col>
            <ion-col size="4" style="text-align: right">
              <ion-label class="commentTime">{{timeSince(comment.created_date)}}</ion-label>
            </ion-col>
            <ion-col size="12" class="commentText">
              <span> {{comment.comment_text}}</span>
            </ion-col>
            <ion-col size="12">
              <ion-label id="commentLike{{comment.id}}" class="optionLike {{comment.likeStatus?'likeActive':''}}" (click)="likeComment(comment.id, 'commentLike'+comment.id)">
                <ion-icon name="thumbs-up"></ion-icon>
                Like
              </ion-label>
              <ion-label class="optionComment ion-margin" (click)="setReplyData(comment.first_name+' '+comment.last_name, comment.id)">
                <ion-icon name="share-alt" style="transform: rotateY(180deg)"></ion-icon>
                Reply
              </ion-label>
            </ion-col>
          </ion-row>
        </ion-col>
        <ion-col size="2"></ion-col>
        <ion-col size="10">
          <ion-row class="like-row" *ngFor="let reply of replies[comment.id]"  >
            <ion-col size="2" (click)="getUserProfile(reply.user_id, reply.profile_picture, reply.first_name+' '+reply.last_name)">
              <ion-avatar class="avatar userImg">
                <img class="" [src]="profileimg(reply.profile_picture)"/>
              </ion-avatar>
            </ion-col>
            <ion-col class="" size="10">
              <ion-row>
                <ion-col size="8" (click)="getUserProfile(reply.user_id, reply.profile_picture, reply.first_name+' '+reply.last_name)">
                  <ion-label class="" >
                    <span class="username-span">{{reply.first_name+' '+reply.last_name|titlecase}}</span>
                  </ion-label>
                </ion-col>
                <ion-col size="4" style="text-align: right">
                  <ion-label class="commentTime">{{timeSince(reply.created_date)}}</ion-label>
                </ion-col>
                <ion-col size="12" class="commentText">
                  <span> {{reply.comment_text}}</span>
                </ion-col>
              </ion-row>
            </ion-col>
          </ion-row>
        </ion-col>
        <hr style="background-color: #f3f3f3; width:95%" />
      </ion-row>
    </ion-grid>
  </ion-list>
  <ion-spinner class="spinner" name="crescent" *ngIf="!comments && !noData"></ion-spinner>
  <ion-row >
    <ion-col class="noCommentsMsg">
      <ion-text *ngIf="!comments && noData">No Comments Yet</ion-text>
    </ion-col>
  </ion-row>
</ion-content>
<ion-footer class="replyText" *ngIf="replyData!=null">
  <ion-grid>
    <ion-row>
      <ion-col size="11">
        Replying to {{replyData.name}}
      </ion-col>
      <ion-col size="1">
        <ion-icon name="close" (click)="replyData=null"></ion-icon>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-footer>
<ion-footer>
  <ion-grid>
    <ion-row>
      <ion-col size="10">
        <ion-input class="newComment" placeholder="Write a Comment..." [(ngModel)]="newComment" name="newComment"></ion-input>
      </ion-col>
      <ion-col size="2">
        <ion-button class="commentButton" (click)="addComment()" [disabled]="!newComment">
          <ion-icon name="send"></ion-icon>
        </ion-button>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-footer>

