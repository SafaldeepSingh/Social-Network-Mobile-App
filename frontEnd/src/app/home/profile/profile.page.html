<ion-content color="light">
  <div class="coverPhoto">
    <ion-img  src="assets/image/zx.png"></ion-img>
    <ion-icon name="arrow-back" (click)="back()" class="back__btn"></ion-icon>
    <div [innerText]="userData.name| titlecase"></div>
  </div>
  <div class="profilePhoto" (click)="changeProfilePhoto()">
    <img class="" [src]="https(userData.profileImage)"   />
      <button class="editProfileImg">
        <ion-icon name="add"></ion-icon>
      </button>
  </div>
  <div class="details">
    <ion-grid>
      <ion-row>
        <ion-col size="3"></ion-col>
        <ion-col size="2">
          Posts <br/>{{postCount}}
        </ion-col>
        <ion-col size="3"  (click)="openFollowers()">
          Followers <br/>{{userData.followers?userData.followers.length:'--'}}
        </ion-col>
        <ion-col size="3"  (click)="openFollowings()">
          Followings <br/>{{userData.followings? userData.followings.length:'--'}}
        </ion-col>
        <ion-col size="1"></ion-col>
      </ion-row>
    </ion-grid>
    <hr class="hr">
  </div>
  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content>
    </ion-refresher-content>
  </ion-refresher>
  <div class="posts">
    <ion-card class="cardchange" *ngFor="let content of contents, let ci = index">
      <ion-card-header class="header-content ">
        <ion-list lines="none " style="padding-bottom :0; padding-top: 0 ">
          <ion-item>
            <img class="avatar-photo" [src]="https(content.userData.profile_picture)" />
            <ion-label  class="card-title ion-margin ">{{ content.userData.first_name+' '+content.userData.last_name}}</ion-label>
            <button style="margin-top:6px " class="butn1 ">
              <ion-icon name="more"></ion-icon>
            </button>
          </ion-item>
          <hr style="    background-color: #cde2de;
                      width: 88%;
                      margin-right: 6%;
                   " *ngIf="content.share_post_id == -1"/>
        </ion-list>
      </ion-card-header>
      <ion-card-content style="padding-left:18px" class="cardcontent" *ngIf="content.share_post_id==-1">
        <b>{{ content.post_title }}</b><br/>
        {{ content.post_content }}
        <div *ngIf="checkAttachment(content.post_id)">
          <div *ngFor="let img_url of content.sharePost.attachments; index as i" style="position: relative"
               class="d-inline-block p-1 o-fit-cover {{getClass(content.sharePost.attachments.length, i)}}"
               (click)="viewAllImages(content.sharePost)">
            <div class="moreImages__txt" *ngIf="i>=4 && content.sharePost.attachments.length>5">
              +{{content.sharePost.attachments.length - 4}}
            </div>
            <img class="o-fit-cover h-100 w-100 {{content.sharePost.attachments.length>5 && i===4?'black-layer':''}}"
                 [src]="https(img_url.attachment)" >
          </div>
        </div>
        <ion-row style="margin-top:6px;">
          <ion-col size="1" class="p-0"  *ngFor="let like of likes[content.post_id]">
            <img class="img-like"  [src]="like.profile_picture" *ngIf="like.user != userData.id" [alt]="like.first_name"/>
          </ion-col>
          <ion-col style="margin-top:3px">
            <span class="likes " (click)="likeModal(content.post_id)"> {{content.like_count}} Likes</span>
            <span class="likes " (click)="reactModal(content.post_id)">
                        &nbsp;&nbsp;{{ content.comment_count }} Reactions
                      </span>
          </ion-col>
        </ion-row>
      </ion-card-content>
      <ion-card-content class="py-0 mb-2" *ngIf="content.share_post_id !=-1" [innerText]="content.post_content"></ion-card-content>
      <ion-card  class="cardchange mt-0" *ngIf="content.share_post_id != -1">
        <ion-card-header class="header-content ">
          <ion-list lines="none " style="padding-bottom :0; padding-top: 0 ">
            <ion-item>
              <img class="avatar-photo" [src]="content.sharePost.userData.profile_picture" />
              <ion-label  class="card-title ion-margin ">{{ content.sharePost.userData.first_name+' '+content.sharePost.userData.last_name}}</ion-label>
            </ion-item>
            <hr style="    background-color: #cde2de;
                      width: 88%;
                      margin-right: 6%;
                   "/>
          </ion-list>
        </ion-card-header>
        <ion-card-content style="padding-left:18px" class="cardcontent">
          <b>{{ content.sharePost.post_title }}</b><br/>
          {{ content.sharePost.post_content }}
          <div *ngIf="checkAttachment(content.sharePost.post_id)">
            <ion-row>
              <ion-col
                      *ngFor="let img_url of content.sharePost.attachments; index as i">
                <ion-img style="width:100%"
                         [ngStyle]="{
                              'width:33%': i > 2 && i < 4,
                              'width:50%': (i > 1 && i < 3) || (i > 2 && i < 5),
                              'width:100%': i === 1                          }"
                         [src]="https(img_url.attachment)"
                ></ion-img>
              </ion-col>
            </ion-row>
          </div>
        </ion-card-content>
      </ion-card>
      <ion-card-content class="py-0" *ngIf="content.share_post_id !=-1">
        <ion-row style="margin-top:6px;">
          <ion-col size="1" class="p-0"  *ngFor="let like of likes[content.post_id]">
            <img class="img-like"  [src]="like.profile_picture" *ngIf="like.user != userData.id" [alt]="like.first_name"/>
          </ion-col>
          <ion-col style="margin-top:3px">
            <span class="likes " (click)="likeModal(content.post_id)"> {{content.like_count}} Likes</span>
            <span class="likes " (click)="reactModal(content.post_id)">
                        &nbsp;&nbsp;{{ content.comment_count }} Reactions
                      </span>
          </ion-col>
        </ion-row>
      </ion-card-content>
      <hr style="background-color: #cde2de; " />
      <ion-card-subtitle>
        <button id="postLikeButton{{content.post_id}}" class="butn2 {{content.likeStatus?'likeActive':''}}" (click)="likePost(content.post_id, 'postLikeButton'+content.post_id, ci, content.user_id)">
          <ion-icon name="thumbs-up"></ion-icon>
          Like
        </button>
        <button (click)="reactModal(content.post_id)" class="butn2" id="react">
          <ion-icon name="create" ></ion-icon> React
        </button>
        <button class="butn2 " (click)="sharePost(content.share_post_id==-1?content.post_id:content.sharePost.post_id)">
          <ion-icon name="share-alt"></ion-icon> Share</button>
        <span class="time-ago ">{{ timeSince(content.created_date) }}</span>
      </ion-card-subtitle>
          </ion-card>
  </div>
  <div *ngIf="!contents && !showLoading" class="noPostMsg">No Posts to Show</div>
  <div *ngIf="!contents && showLoading">
    <ion-card  class="cardchange">
      <ion-item>
        <ion-thumbnail slot="start">
          <ion-skeleton-text animated></ion-skeleton-text>
        </ion-thumbnail>
        <ion-label>
          <h3>
            <ion-skeleton-text animated style="width: 80%"></ion-skeleton-text>
          </h3>
          <p>
            <ion-skeleton-text animated style="width: 60%"></ion-skeleton-text>
          </p>
          <p>
            <ion-skeleton-text animated style="width: 50%"></ion-skeleton-text>
          </p>
        </ion-label>
      </ion-item>
      <ion-item>
        <ion-label>
          <h3>
            <ion-skeleton-text animated style="width: 80%"></ion-skeleton-text>
          </h3>
          <p>
            <ion-skeleton-text animated style="width: 60%"></ion-skeleton-text>
          </p>
          <p>
            <ion-skeleton-text animated style="width: 50%"></ion-skeleton-text>
          </p>
        </ion-label>
      </ion-item>
    </ion-card>
  </div>
</ion-content>
